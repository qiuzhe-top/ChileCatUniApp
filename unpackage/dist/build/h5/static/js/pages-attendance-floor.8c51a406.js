(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-attendance-floor"],{"0381":function(t,e,s){"use strict";s.r(e);var o=s("3bb8"),a=s("b0b9");for(var i in a)"default"!==i&&function(t){s.d(e,t,(function(){return a[t]}))}(i);s("f046");var n,r=s("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"10efde66",null,!1,o["a"],n);e["default"]=c.exports},"3bb8":function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return o}));var o={uRow:s("c909").default,uCol:s("d8d9").default,uBadge:s("c7e2").default},a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-uni-view",{staticClass:"floor"},t._l(t.floor_list,(function(e,o){return s("v-uni-view",{key:e.id},[s("v-uni-view",{staticClass:"title"},[t._v(t._s(o)+"号楼")]),s("u-row",{attrs:{gutter:"1"}},t._l(e,(function(e,a){return s("u-col",{key:a,attrs:{span:"3"}},[s("v-uni-view",{staticClass:"level",class:{active:t.statistical(o,a)[0]===t.statistical(o,a)[1],level:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.to_room(o,a)}}},[t._v("第"+t._s(a)+"层"),s("u-badge",{attrs:{bgColor:"#04b8fc",size:"mini",count:"+"+t.statistical(o,a)[0],offset:[-10,-15]}})],1)],1)})),1)],1)})),1)},i=[]},a824:function(t,e,s){"use strict";(function(t){s("c975"),s("fb6a"),s("ac1f"),s("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s("96b1"),a={data:function(){return{floor_list:[],type:"0",value:100}},mounted:function(){this.init_floor(),this.initWebSocket(),this.type=this.vuex_task.type},destroyed:function(){this.websock.close()},methods:{statistical:function(t,e){var s=this.vuex_call[this.vuex_task.type][t+"#"+e],o=0,a=0;for(var i in s){var n=s[i],r=n["status"];"1"==r&&(a+=1),o+=1}return[a,o]},initWebSocket:function(){this.websock=new WebSocket("ws://"+(0,o.getIpAddres)()+"/ws/room/status"),this.websock.onmessage=this.message,this.websock.onopen=this.onopen,this.websock.onerror=this.onerror,this.websock.onclose=this.onclose},onerror:function(e){t.log(e,e.code,e.reason,e.wasClean)},onopen:function(e){var s=this.vuex_call[this.type];if(t.log("socket连接成功"),s){var o=JSON.stringify({buildings:s,type:this.type});this.websock.send(o)}},onclose:function(e){t.log("断开",e.code,e.reason,e.wasClean)},message:function(e){var s=JSON.parse(e.data);if(t.log("接受",s),"all_status"===s["type"]){var o=s["data"]["buildings"],a=s["data"]["info"];this.$store.dispatch("save",["vuex_call."+this.type,o]),this.$store.dispatch("save",["vuex_room_user_info",a])}else if("send_status"===s["type"]){t.log("接受新状态");a=s["data"];var i=a["status_type"],n="."+a["task_type"],r=a["status"],c=a["room"],u="."+c.substr(0,c.indexOf("#")+2),l="."+c.slice(-2),f="";if("room"===i)f="vuex_call"+n+u+l+".status";else if("user"===i){var d=a["username"];f="vuex_call"+n+u+l+"."+d}this.$store.dispatch("save",[f,r])}},init_room_status:function(e){var s=JSON.stringify(this.vuex_call),o=JSON.parse(s);for(var a in t.log(o),e){var i=e[a],n=a.split("_"),r=n[0],c=r.substr(0,3)+"",u=r.substr(3,4)+"";"3#101"===r&&t.log(r,i);try{o[c][u][this.vuex_task.type_name]=1,o[c][u]["t"]=i}catch(l){}}this.$store.dispatch("save",["vuex_call",o]),t.log(o)},init_floor:function(){this.$data.floor_list=this.vuex_task.rooms},to_room:function(t,e){this.$store.dispatch("save",["vuex_floor_now",{id:t,name:t}]),this.$store.dispatch("save",["vuex_layer_now",{id:e,name:e}]),this.$u.route("/pages/attendance/room")}}};e.default=a}).call(this,s("5a52")["default"])},b0b9:function(t,e,s){"use strict";s.r(e);var o=s("a824"),a=s.n(o);for(var i in o)"default"!==i&&function(t){s.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},dfcc:function(t,e,s){var o=s("fe19");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var a=s("4f06").default;a("4520af68",o,!0,{sourceMap:!1,shadowMode:!1})},f046:function(t,e,s){"use strict";var o=s("dfcc"),a=s.n(o);a.a},fe19:function(t,e,s){var o=s("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为uView UI的集成样式文件，为scss预处理器，其中包含了一些"u-"开头的自定义变量\r\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\r\n * uView自定义的css类名和scss变量，均以"u-"开头，不会造成冲突，请放心使用 \r\n */.title[data-v-10efde66]{font-size:%?38?%;color:#04b8fc;font-weight:700;margin-bottom:%?30?%;margin-top:%?20?%}.level[data-v-10efde66]{padding:%?20?% %?40?%;margin:10px %?10?%;display:inline-block;font-weight:700;color:#999;box-shadow:#e8e8e8 1px 1px 10px;position:relative}.level[data-v-10efde66]:last-child{margin-right:auto}.active[data-v-10efde66]{background-color:#04b8fc;color:#fff}.error[data-v-10efde66]{background-color:#ff557f;color:#fff}.floor[data-v-10efde66]{padding:%?20?%}',""]),t.exports=e}}]);